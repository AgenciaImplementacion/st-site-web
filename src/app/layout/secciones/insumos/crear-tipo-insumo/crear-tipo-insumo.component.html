<div>
    <app-page-header [heading]="'Caracterización de Insumos'" [icon]="'fa-star'">
    </app-page-header>
    <div #actionForm class="card text-center m-2 mb-3">
        <div class="card-header">
            <h2>Caracterización de Insumos</h2>
        </div>
    </div>
    <div class="row justify-content-center text-center m-2 mb-3">
        <div class="card text-left col-12">

            <div class="card-header">
                <h3>Insumo a caracterizar <span *ngIf="id>0"><b>#{{id}}</b></span></h3>
            </div>
            <div class="card-body">

                <form action="" method="post">
                    <div class="row mb-2">

                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" aria-required="true">* Perfil</label>
                                </div>
                                <select class="custom-select" name="providerProfile" id="providerProfile"
                                    (change)="modelChanged()" [(ngModel)]="providerProfile">
                                    <option value='0' selected>Seleccione el perfil</option>
                                    <option [ngValue]="item.id" *ngFor="let item of providerProfiles">{{item.name}}
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" aria-required="true">* Nombre del insumo</label>
                                </div>
                                <input class="form-control" (change)="modelChanged()" [(ngModel)]="typeSupplyName"
                                    type="text" name="typeSupplyName" placeholder="">
                            </div>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend input-group-text">
                                    <div class="">Descripción</div>
                                </div>
                                <textarea class="form-control" id="observations" rows="2" (change)="modelChanged()"
                                    [(ngModel)]="typeSupplyDescription" name="typeSupplyDescription"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" aria-required="true">Metadato</label>
                                </div>
                                <select class="custom-select" name="metadataRequired" id="metadataRequired"
                                    (change)="modelChanged()" [(ngModel)]="metadataRequired">
                                    <option [ngValue]="item.id" *ngFor="let item of booleanOptions">{{item.name}}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" aria-required="true">Modelo</label>
                                </div>
                                <select class="custom-select" name="modelRequired" id="modelRequired"
                                    (change)="modelChanged()" [(ngModel)]="modelRequired">
                                    <option [ngValue]="item.id" *ngFor="let item of booleanOptions">{{item.name}}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class='col mb-1'>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" aria-required="true">Formatos del insumo</label>
                                </div>
                                <ng-select2 [data]="exampleData" [options]="options" [width]="500"
                                    [(ngModel)]="extensions" (valueChanged)="modelChanged()">
                                </ng-select2>
                                <!-- <input class="form-control" (change)="modelChanged()" [(ngModel)]="extensions"
                                    type="text" name="extensions" placeholder=""> -->
                            </div>
                            <small class="form-text text-muted">Ingrese las extensiones soportadas separadas por
                                comas (ej: png, jpg, bmp)</small>
                        </div>
                    </div>

                </form>
            </div>
            <div class="card-footer text-muted text-center">
                <button type="button" [disabled]="!formOk" *ngIf="!editMode" class="btn btn-dark"
                    (click)="createTypeSupply()">Crear Insumo</button>
                <button type="button" [disabled]="!formOk" *ngIf="editMode" class="btn btn-dark"
                    (click)="saveTypeSupply()">Guardar Insumo</button>
                <button type="button" style="margin-left: 10px;" class="btn btn-dark"
                    (click)="cancel()">Cancelar</button>
            </div>
        </div>
    </div>
    <div class="row justify-content-center text-center m-2">
        <div class="card text-left col">
            <div class="card-header">
                <h3>Insumos caracterizados para su entidad</h3>
            </div>
            <div class="card-body">
                <div class="table-inverse table-responsive">
                    <table *ngIf="supplies.length > 0" class="table table-striped">
                        <thead class="thead-inverse">
                            <tr>
                                <th>ID</th>
                                <th>Nombre Insumo</th>
                                <th>Descripción</th>
                                <th>Formato</th>
                                <th>Editar</th>
                                <th>Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr [style.background-color]="item.id==id ? '#3ada1273' : ''"
                                [style.font-weight]="item.id==id ? 'bold' : ''"
                                *ngFor="let item of supplies; let i = index">
                                <td scope="row">{{item.id}}</td>
                                <td scope="row">{{item.name}}</td>
                                <td scope="row">{{item.description}}</td>
                                <td scope="row">
                                    {{extensionsToString(item.extensions)}}
                                </td>
                                <td scope="row" class="text-center">
                                    <i class="material-icons cursor" (click)="selectTypeSupply(item)">
                                        edit
                                    </i>
                                    <!--
                                    &nbsp;
                                    <label class="switch" title="Activar/Desactivar Insumo">
                                        <input type="checkbox">
                                        <span class="slider round"></span>
                                    </label>
                                    -->
                                </td>
                                <td class="text-center">
                                    <i class="material-icons cursor"
                                        (click)="deleteTypeSupply('modalDisabled', item.id)">
                                        delete
                                    </i>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
                <div *ngIf="supplies.length === 0" class="row mt-3">
                    <div class="col-12">
                        <div class="alert alert-primary text-center" role="alert">
                            No tienes insumos
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<jw-modal id="modalDisabled" class="mt-5">
    <div class="card">
        <!--style="height:500px"  Se puede especificar el height de la ventana modal, o el cojera por defecto el contenido de los elementos-->
        <div class="card-header">
            <i class="cui-arrow-bottom"></i>
            <h2 class="text-center font-weight-bold">
                ¿Está seguro de Eliminar el tipo de insumo?
            </h2>
            <h5 class="alert alert-warning text-center">Advertencia: Esta acción eliminará el tipo de insumo.</h5>
        </div>
        <div class="card-body row">
            <div class="text-center col-sm">
                <button type="button" class="btn btn-primary btn-block"
                    (click)="closeModalDisabled('modalDisabled',true);">
                    <h4>Sí</h4>
                </button>
            </div>
            <div class="text-center col-sm">
                <button type="button" class="btn btn-dark btn-block"
                    (click)="closeModalDisabled('modalDisabled',false);">
                    <h4>No</h4>
                </button>
            </div>
        </div>
    </div>
</jw-modal>